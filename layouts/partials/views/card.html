{{ $item := .item }}
{{ $has_attachments := partial "functions/has_attachments" $item }}

<div class="card-simple view-card" style="margin-bottom: 2rem;">

  {{/* 使用更通用的方式获取图片，避免找不到 partial 的构建错误 */}}
  {{ $resource := ($item.Resources.ByType "image").GetMatch "featured*" }}
  
  {{ with $resource }}
    {{ $image := .Resize "600x" }}
    <a href="{{ $item.RelPermalink }}">
      <img src="{{ $image.RelPermalink }}" class="article-banner" alt="{{ $item.Title }}" 
           style="max-height: 200px; width: 100%; object-fit: cover; border-radius: 4px;">
    </a>
  {{ end }}

  <div class="card-body" style="padding: 15px 0;">
    <h3 class="article-title mb-1 mt-0">
      <a href="{{ $item.RelPermalink }}">{{ $item.Title }}</a>
    </h3>

    <div class="article-metadata" style="font-size: 0.9rem; color: #666; margin-bottom: 8px;">
      <span class="article-date">
        {{ $item.Date.Format "Jan 2, 2006" }}
      </span>
      {{ with $item.Params.authors }}
        <span class="middot-divider"></span>
        <span class="article-authors">
          {{ partial "page_metadata_authors" $item }}
        </span>
      {{ end }}
    </div>

    {{ with $item.Summary }}
    <div class="article-style" style="font-size: 0.95rem; color: #444;">
      <p>{{ . | truncate 135 }}</p>
    </div>
    {{ end }}

    {{ if $has_attachments }}
    <div class="btn-links">
      {{ partial "page_links" (dict "page" $item "is_list" 1) }}
    </div>
    {{ end }}
  </div>
</div>
